<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Relatório de Treinamento MLP – Diabetes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet"/>
  <style>
    :root {
      /* Paleta Dark AMOLED */
      --color-primary: #BB86FC;
      --color-secondary: #03DAC6;
      --color-background: #000000;
      --color-surface: #121212;
      --color-on-surface: #E0E0E0;
      --font-family: 'Roboto', sans-serif;
      --elevation: 0 1px 3px rgba(0,0,0,0.9), 0 1px 2px rgba(0,0,0,0.9);
      --spacing-unit: 16px;
    }
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      background-color: var(--color-background);
      color: var(--color-on-surface);
      font-family: var(--font-family);
      line-height: 1.6;
      padding-top: calc(var(--spacing-unit) * 5);
    }
    nav {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      background-color: var(--color-surface);
      box-shadow: var(--elevation);
      z-index: 100;
    }
    nav .container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      padding: var(--spacing-unit);
    }
    nav .logo {
      font-weight: 500;
      font-size: 1.25rem;
      color: var(--color-primary);
      margin-right: auto;
    }
    nav ul {
      list-style: none;
      display: flex;
      gap: calc(var(--spacing-unit) * 1.5);
    }
    nav a {
      text-decoration: none;
      color: var(--color-on-surface);
      font-weight: 500;
      transition: color 0.2s;
      cursor: pointer;
    }
    nav a:hover {
      color: var(--color-primary);
    }
    #main-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: var(--spacing-unit);
    }
    section {
      margin-bottom: calc(var(--spacing-unit) * 4);
    }
    section h2 {
      font-size: 1.75rem;
      margin-bottom: var(--spacing-unit);
      color: var(--color-secondary);
    }
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: var(--spacing-unit);
    }
    .card {
      background-color: var(--color-surface);
      padding: var(--spacing-unit);
      border-radius: 8px;
      box-shadow: var(--elevation);
    }
    .card h3 {
      font-size: 1.125rem;
      margin-bottom: calc(var(--spacing-unit) / 2);
      color: var(--color-primary);
    }
    .text-container {
      min-height: 100px;
      background-color: var(--color-background);
      border-radius: 4px;
      padding: var(--spacing-unit);
      color: var(--color-on-surface);
    }
    .chart-container,
    .image-container,
    .table-container {
      min-height: 200px;
      background-color: var(--color-surface);
      border-radius: 8px;
      box-shadow: var(--elevation);
      margin-top: var(--spacing-unit);
    }
    @media (max-width: 600px) {
      nav .container {
        flex-direction: column;
        gap: var(--spacing-unit);
      }
      body {
        padding-top: calc(var(--spacing-unit) * 7);
      }
    }
  </style>
</head>
<body>
  <nav>
    <div class="container">
      <div class="logo">MLP Diabetes</div>
      <ul>
        <li><a href="#" data-template="overview-template">Visão Geral</a></li>
        <li><a href="#" data-template="data-template">Resultados</a></li>
        <li><a href="#" data-template="results-template">Conclusão</a></li>
      </ul>
    </div>
  </nav>

  <div id="main-content"></div>

  <!-- Templates integrados -->
  <template id="overview-template">
    <section id="overview">
      <h2>Visão Geral</h2>
      <div class="card-grid">
        <div class="card">
          <h3>Descrição Geral</h3>
          <div class="text-container">
            <h4>Modelo MLP para Diagnóstico de Diabetes</h4>
            <br>
            <p>Este relatório apresenta os resultados do treinamento de uma Rede Neural Perceptron Multicamadas (MLP) para prever a presença de diabetes em pacientes. O modelo foi treinado com um conjunto de dados contendo informações médicas relevantes, visando auxiliar no diagnóstico precoce da doença.</p>
            <br>
            <p>A MLP é uma arquitetura de rede neural que consiste em múltiplas camadas de neurônios, permitindo a modelagem de relações complexas entre as variáveis de entrada e a saída desejada. O treinamento foi realizado utilizando variadas técnicas em conjunto, bem como algumas implementações únicas.</p>
            <br>
            <p>Este relatório inclui detalhes sobre a configuração do modelo, os dados utilizados, as estatísticas descritivas, as curvas de treinamento e as métricas de desempenho. O objetivo é fornecer uma visão abrangente do processo de desenvolvimento e avaliação do modelo MLP para diagnóstico de diabetes.</p>
          </div>
        </div>
        <div class="card">
          <h3>Objetivos</h3>
          <div class="text-container">
            <ul>
              <li>Desenvolver um ferramenta robusta capaz de treinar modelos MLP utilizando Scikit-learn (Python) para classificação binária.</li>
              <li>Minimizar Falsos Negativos sem comprometer a Precisão.</li>
              <li>Avaliar e validar o desempenho do modelo treinado contra múltiplas instâncias da base de dados.</li>
              <li>Gerar relatórios detalhados com estatísticas, curvas de treinamento e matriz de confusão.</li>
            </ul>
            <div class="image-container">
              <img src="./content/cmatrix.png" alt="Matriz de Confusão" style="width: 100%; height: auto; border-radius: 4px;">
              <small>Figura 1: Matriz de Confusão de Modelos MLP (classificação binária)</small>
            </div>
          </div>
        </div>
      </div>
    </section>
  </template>

  <template id="data-template">
    <section id="data">
      <h2>Resultados</h2>
      <div class="card-grid">
        <div class="card">
          <h3>Estatísticas</h3>
          <div class="image-container">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <img src="./content/low_fn.png" alt="Estatísticas dos Dados" style="width: 49%; height: auto; border-radius: 4px;">
              <img src="./content/low_fn2.png" alt="Estatísticas dos Dados" style="width: 49%; height: auto; border-radius: 4px;">
            </div>
            <br>
            <li>Figura 2: Melhor modelo obtido a partir de pima.csv</li>
            <li>Figura 3: Melhor modelo obtido a partir do conjunto (pima, pima-0n, pima-1n, pima-2n).csv</li>
            <br>
            <p>Como podemos observar, a minimização agressiva de Falsos Negativos infere em uma redução da precisão do modelo como um todo. Isto prejudica a "correctividade" do modelo: o quão correto seu output é. Por causa disso, o modelo apresentado na Figura 2 foi descartado.</p>
            <br>
            <p>Entretanto, a ferramenta permite que o usuário combine múltiplas instâncias da base de dados, como pode ser observado na Figura 3. Assim, a abordagem tomada foi de combinar repetidas entradas baseado na qualidade destas quanto à presença de nulos: quanto mais completa a entrada, maior a possibilidade desta estar repetida dentre as outras instâncias. A tolerância máxima permitida para repetição foi de 2 nulos por entrada.</p>
            <br>
            <p>Ainda assim, a base completa foi utilizada, gerando um modelo que "conhece" todas as possibilidades apresentadas na coleta de dados real.</p>
            <br>
            <p>As métricas utilizadas para o modelo final apresentado na Figura 3 foram:</p>
            <pre>

class BestBy(Enum):
    VAL_LOSS        = (0, "min")
    FALSE_NEGATIVE  = (1, "min")
    FALSE_POSITIVE  = (2, "min")
    
    TRUE_POSITIVE   = (3, "max")
    TRUE_NEGATIVE   = (4, "max")
    DIFF_POSITIVE   = (5, "max")
    DIFF_NEGATIVE   = (6, "max")
    F1_SCORE        = (7, "max")
    ACCURACY        = (8, "max")
    PRECISION       = (9, "max")
    RECALL          = (10, "max")

class FillStrategy(Enum):
    MEAN=1; MEDIAN=2; MODE=3; ITER=4; KEEP=5; ZERO=6

class Activation(str, Enum):
    RELU="relu"; TANH="tanh"; LINEAR="identity"; SIGMOID="logistic"
    @classmethod
    def from_str(cls, name:str)->"Activation":
        try: return cls[name.upper()]
        except KeyError as exc: raise ValueError(f"Invalid activation: {name}") from exc

@dataclass(frozen=True, slots=True)
class HyperParams:
    k_folds:        int     = 8
    batch_size:     int     = 32
    epochs:         int     = 1024
    patience:       int     = 64
    watch_for:      BestBy  = BestBy.FALSE_NEGATIVE
    min_delta:      float   = 3e-6
    learning_rate:  float   = 6e-3
    
    layers: tuple[tuple[Activation,int],...] = (
        (Activation.TANH,8),
        (Activation.TANH,4),
        (Activation.LINEAR,2),
        (Activation.SIGMOID,1)
    )

@dataclass(frozen=True, slots=True)
class Config:
    csv_dir:        Path    = Path(".data")
    log_dir:        Path    = Path(".log")
    img_dir:        Path    = Path(".img")
    mdl_dir:        Path    = Path(".models")
    csv_sep:        str     = ";"
    scramble_rows:  bool    = True
    normalize:      bool    = True
    null_value:     Optional[float] = 0
    fill_strategy:  FillStrategy = FillStrategy.KEEP
    exclude_cols:   tuple[int,...] = (0,)

            </pre>
          </div>
        </div>
      </div>
    </section>
  </template>

  <template id="results-template">
    <section id="results">
      <h2>Resultados</h2>
      <div class="card-grid">
        <div class="card">
          <h3>Aprendizado</h3>
          <div class="text-container">
            <li>O programa usou a biblioteca Scikit-learn (Python) que conta com uma robsuta documentação, similar ao MatPlotLib. O uso destas combinado com as bibliotecas NumPy e Pandas produziu uma ferramenta capaz e versátil, ainda que com espaço para muitas melhorias. Múltiplas abordagens e estratégias foram possibilitadas através desta ferramenta.</li>
            <br>
            <li>Foi-se capaz de treinar modelos MLP capazes de prever a presença de diabetes em pacientes com base em dados de pacientes com diabetes e sem diabetes. O tratamento de nulos na base de dados foi um processo muito importante, ajudando a tirar o melhor proveito das entradas sem depender excessivamente da integridade dos dados, gerando modelos robustos.</li>
            <br>
            <li>O modelo final foi treinado com uma base de dados combinada, contendo todas as instâncias disponíveis, e obteve resultados satisfatórios em termos de precisão e recall. A matriz de confusão gerada pelo modelo final mostra que ele é capaz de identificar corretamente a presença de diabetes na maioria dos casos, ainda minimizando os falsos negativos.</li>
            <br>
            <br>
            <p>Documentação das bibliotecas utilizadas:</p>
              <li><a href="https://scikit-learn.org/stable/index.html">Scikit-learn</a></li>
              <li><a href="https://matplotlib.org/stable/index.html">Matplotlib</a></li>
              <li><a href="https://numpy.org/doc/stable/">NumPy</a></li>
              <li><a href="https://pandas.pydata.org/docs/">Pandas</a></li>
            </p>
            <br>
            <p>LLMs utilizadas:
              <li>GPT o3</li>
              <li>GPT o4-mini</li>
              <li>Claude 4 Opus</li>
              <br>
              O uso destas foi possibilitado através da plataforma <a href="https://www.getmerlin.in/chat">Merlin AI</a>, uma recomendação pessoal minha para o uso de LLMs em projetos de pesquisa.
            </p>
          </div>
        </div>
      </div>
    </section>
  </template>

  <script>
    // Carrega a seção a partir do template
    function loadSection(templateId) {
      const tpl = document.getElementById(templateId);
      const clone = tpl.content.cloneNode(true);
      const target = document.getElementById('main-content');
      target.innerHTML = '';
      target.appendChild(clone);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Exibe Visão Geral por padrão
      loadSection('overview-template');

      // Vincula cliques do menu
      document.querySelectorAll('nav a[data-template]').forEach(link => {
        link.addEventListener('click', e => {
          e.preventDefault();
          const tplId = link.getAttribute('data-template');
          loadSection(tplId);
        });
      });
    });
  </script>
</body>
</html>