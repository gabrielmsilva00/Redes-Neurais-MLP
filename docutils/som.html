<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Relatório de Treinamento SOM – Mapas de Kohonen</title>
  <link href="style.css" rel="stylesheet"/>
  <link href="https://unpkg.com/prismjs@1.30.0/themes/prism-okaidia.min.css" rel="stylesheet"/>
  <script src="https://unpkg.com/prismjs@1.30.0/components/prism-core.min.js" defer></script>
  <script src="https://unpkg.com/prismjs@1.30.0/components/prism-python.min.js" defer></script>
  <script src="https://unpkg.com/prismjs@1.30.0/plugins/file-highlight/prism-file-highlight.min.js" defer></script>
  <script src="https://unpkg.com/prismjs@1.30.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js" defer></script>
  <script src="script.js" defer></script>
</head>
<body>
  <nav>
    <div class="container">
      <a href="../index.html" style="display: flex; align-items: center; justify-content: center; background: var(--color-background); height: 1.5em; width: 1.5em; color: var(--color-primary); font-weight: 700; font-size: 1.5rem; border: 2px solid var(--color-primary); border-radius: 50px; padding: 0.5em; margin-right: 0.5em; cursor: pointer; text-decoration: none;">⤾</a>
      <div class="logo">SOM - Kohonen</div>
      <ul>
        <li><a href="#" data-template="overview-template">Introdução</a></li>
        <li><a href="#" data-template="data-template">Discussão</a></li>
        <li><a href="#" data-template="code-template">Código</a></li>
        <li><a href="#" data-template="results-template">Conclusão</a></li>
      </ul>
    </div>
  </nav>
  <div id="main-content"></div>

  <!-- Templates integrados -->
  <template id="overview-template">
    <section id="overview">
      <h2>Introdução</h2>
      <div class="card-grid">
        <div class="card">
          <h3>Descrição Geral</h3>
          <div class="text-container">
            <h4>Modelo Kohonen em Treinamento Não Supervisionado</h4>
            <br>
            <p>
              &emsp;&emsp;Este relatório tem como objetivo expor as investigações acerca do modelo Kohonen, também conhecido como SOM (Self-Organizing Map), com o objetivo de encontrar a melhor classificação das amostras, além de analisar o comportamento do mapa auto-organizável em termos de visualização de dados.
              <br><br>
              &emsp;&emsp;A base de dados utilizada contém informações sobre plantas do gênero Íris, onde encontramos as variáveis:
              <br><br>
              <li>comprimento da sépala</li>
              <li>largura da sépala</li>
              <li>comprimento da pétala</li>
              <li>largura da pétala</li>
              <br>
              &emsp;&emsp;Com a aplicação do modelo Kohonen, espera-se identificar agrupamentos que correspondam às diferentes espécies das plantas, evidenciando, sem uma rotulação direta, a quais classes cada amostra provavelmente pertence.
            </p>
          </div>
        </div>
        <div class="card">
          <h3>Objetivos</h3>
          <div class="text-container">
            <li>Analisar os parâmetros do modelo Kohonen (SOM) que obtém um melhor resultado para a base Íris.</li>
            <li>Comparar resultados visuais dos mapas gerados para diferentes configurações.</li>
            <li>Contrastar os resultados obtidos contra a base de dados real e discutir possíveis disparidades.</li>
            <div class="image-container">
              <img src="content/kohonen.png" alt="Mapa Inicial Kohonen" style="width: 100%; height: auto; border-radius: 4px;">
              <small>Figura 1: Funcionamento de um modelo de Kohonen. [Fonte: <a href="https://www.cin.ufpe.br/~lfsc/cursos/introducaoainteligenciaartificial/IA-Aula11-MapasAutoOrganizaveis.pdf">UFPE</a>]</small>
            </div>
          </div>
        </div>
      </div>
    </section>
  </template>

  <template id="code-template">
    <section id="code">
      <h2>Código</h2>
      <div class="card-grid">
        <div class="card">
          <h3>SOM.py</h3>
          <pre data-src="https://raw.githubusercontent.com/gabrielmsilva00/Redes-Neurais-MLP/refs/heads/main/src/som/som.py"></pre>
        </div>
      </div>
    </section>
  </template>

  <template id="data-template">
    <section id="data">
      <h2>Discussão</h2>
      <div class="card-grid">
        <div class="card">
          <h3>Abordagem</h3>
          <div class="text-container">
            <h4>Hiperparâmetros</h4>
            <p>
              &emsp;&emsp;Os hiperparâmetros correspondem às variáveis que definem a estrutura e o comportamento do processo de treinamento do modelo Kohonen. 
              <br>
              &emsp;&emsp;Entre eles, destacam-se:
              <li>Número de linhas (m) e colunas (n) - definem o tamanho do SOM grid, também chamado de Topologia.</li>
              <li>Taxa de aprendizado inicial (lr) - controla a velocidade da atualização dos pesos. A taxa de aprendizado decai ao longo do treinamento.</li>
              <li>Número de iterações (iters) - determina quantas vezes o modelo será ajustado.</li>
              <li>Raio inicial da vizinhança (radius) - Área de influência dos neurônios vizinhos.</li>
              <li>Chave aleatória (rand) - garante reprodutibilidade dos resultados.</li>
              <br>
              &emsp;&emsp;As investigações envolveram modificações diretas destes hiperparâmetros ao longo de inúmeras execuções do código. Não foram realizadas alterações em tau (constante temporal), esta foi calculada automáticamente através da fórmula:
            </p>
            <br>
            <code style="display: block; text-align: center; margin: 0 auto; padding: 1em; border-radius: 0.5em; border: 1px solid #666; font-size: 0.85em;">n_iter / np.log(cfg.radius)</code>
          </div>
            <br>
            <h3>Etapas</h3>
            <div class="text-container">
            <h4>Fase 1</h4>
            <p>
              &emsp;&emsp;O código foi executado a partir da configuração inicial para análise primária:<br>
              <div style="display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: auto; align-items: center;">
                <img src="content/som_fase1.jpeg" alt="Mapa Configuração Inicial" style="width: 100%; height: auto; border-radius: 4px;">
                <pre style="display: block; margin: 0 auto; padding: 1em; border-radius: 0.5em; border: 1px solid #666; font-size: 0.85em;">
--------------------------------
[SOM - Log de Informações]
Chave Aleatória         : 52
Iterações               : 20000
Topologia               : 10 x 10
Taxa de Aprendizado     : 0.4
Raio Inicial (Sigma)    : 5.00
Tau                     : 12426.70
Melhor Acurácia         : 0.800
Sistema Operacional     : Windows 10.0.19045
Python                  : 3.12.9
--------------------------------</pre>
                <small style="grid-column: 1; grid-row: 2; text-align: center;">Figura 2: Mapa Configuração Inicial</small>
              </div>
            </p>
            <br>
            <h4>Fase 2</h4>
            <p>
              &emsp;&emsp;Testes com diversos ajustes buscaram a melhor parametrização do modelo. Configurações sem hachura que obtiveram resultados satisfatórios estão descritas abaixo, considerando acurácia e qualidade do mapa. Um dos mapas com pior desempenho também está listado.
            </p>
            <h4>Configuração 1</h4>
            <p>
              <b>Chave Aleatória:</b> 65<br>
              Iterações: 1.000 | Topologia: 5x5 | Taxa Aprendizado: 0.5 | Raio Inicial: 3.00 | Tau: 910,24 | Melhor Acurácia: 0.8333<br>
              <img src="content/som_config1.png" alt="Mapa Configuração 1" style="width: 100%; height: auto; border-radius: 4px;">
              <small>Figura 3: Mapa Configuração 1</small><br>
              Separação de classes melhor que a original. A acurácia permaneceu em 83,3%.
            </p>
            <h4>Configuração 2</h4>
            <p>
              <b>Chave Aleatória:</b> 96<br>
              Iterações: 30.000 | Topologia: 10x5 | Taxa Aprendizado: 0.5 | Raio Inicial: 2.50 | Tau: 32.740,70 | Melhor Acurácia: 0.967<br>
              <img src="content/som_config2.png" alt="Mapa Configuração 2" style="width: 100%; height: auto; border-radius: 4px;">
              <small>Figura 4: Mapa Configuração 2</small><br>
              Observa-se destacamento de grupo e “vale” que separa neurônios. A alta acurácia (96,7%) indica divisão dos dados em só dois grupos principais, refletindo a sobreposição nas características de Iris-versicolor e Iris-setosa.
            </p>
            <h4>Configuração 3</h4>
            <p>
              <b>Chave Aleatória:</b> 87<br>
              Iterações: 20.000 | Topologia: 8x4 | Taxa Aprendizado: 0.2 | Raio Inicial: 1.50 | Tau: 49.326,07 | Melhor Acurácia: 0.867<br>
              <img src="content/som_config3.png" alt="Mapa Configuração 3" style="width: 100%; height: auto; border-radius: 4px;">
              <small>Figura 5: Mapa Configuração 3</small><br>
              Menor taxa de aprendizado e raio inicial resultaram numa separação parcial. A acurácia (86,7%) foi inferior e houve maior dificuldade do modelo em definir fronteiras entre classes adjacentes.
            </p>
            <h4>Configuração 4</h4>
            <p>
              <b>Chave Aleatória:</b> 36<br>
              Iterações: 65.536 | Topologia: 8x8 | Taxa Aprendizado: 0.25 | Raio Inicial: 2.00 | Tau: 94.548,46 | Melhor Acurácia: 0.967<br>
              <img src="content/som_config4.png" alt="Mapa Configuração 4" style="width: 100%; height: auto; border-radius: 4px;">
              <small>Figura 6: Mapa Configuração 4</small><br>
              Elevada acurácia (96,7%) e separação mais uniforme das classes. Aumentar iterações e grid melhora a representação topológica, reduzindo sobreposição entre espécies.
            </p>
          </div>
          <h3>Configuração com Hachura</h3>
          <div class="text-container">
            <h4>Configuração 5 – Hachura</h4>
            <p>
              <b>Chave Aleatória:</b> 33<br>
              Iterações: 65.536 | Topologia: 8x8 | Taxa Aprendizado: 0.25 | Raio Inicial: 2.00 | Tau: 94.548,46 | Melhor Acurácia: 0.967<br>
              <img src="content/som_config5.png" alt="Mapa Configuração 5 com Hachura" style="width: 100%; height: auto; border-radius: 4px;">
              <small>Figura 7: Mapa Configuração 5 com hachura</small><br>
              Antes, regiões em branco nos mapas indicavam neurônios não ativados, dificultando a análise clara das zonas de ativação. A aplicação da **técnica de hachura** para marcar essas áreas permitiu identificar “vales” ou regiões sem ativação, facilitando a interpretação dos mapas supervisionado e não supervisionado.
            </p>
          </div>
        </div>
      </div>
    </section>
  </template>

  <template id="results-template">
    <section id="results">
      <h2>Conclusão</h2>
      <div class="card-grid">
        <div class="card">
          <div class="text-container">
            <li>
              Conclui-se que a configuração 5, contendo a técnica de hachura para destaque de neurônios não ativados, apresentou melhor desempenho e maior clareza visual dos resultados. 
              Os testes evidenciaram a importância do ajuste de hiperparâmetros, sendo que grids maiores e mais iterações aprimoram a separação das classes.
            </li>
            <br>
            <li>
              A técnica de hachura facilitou uma análise mais precisa das regiões de ativação e ajudou a evitar interpretações errôneas causadas pelos neurônios não ativados.
            </li>
            <br>
            <li>
              O modelo Kohonen, aliado a uma análise crítica dos mapas gerados, evidenciou os limites da acurácia como métrica isolada, destacando a relevância de visualizações claras de clusterização para compreender a estrutura dos dados.
            </li>
            <br>
            <p><strong>Referências:</strong><br>
              FISHER, Ronald. Iris. <a href="https://archive.ics.uci.edu/dataset/53/iris">https://archive.ics.uci.edu/dataset/53/iris</a>.<br>
              KLÖSGEN, Willi; MAY, Michael. <a href="https://doi.org/10.1007/3-540-45681-3_23">Spatial subgroup mining integrated in an object-relational spatial database</a>. Springer, 2002.<br>
              REIS, Carlos. <a href="https://carlos-henreis.github.io/files/Monografia_TFG.pdf">Otimização de Hiperparâmetros em Redes Neurais Profundas</a>, UNIFEI, 2018.
            </p>
            <br>
            <p>
              <strong>Documentação das bibliotecas sugeridas:</strong><br>
              <li><a href="https://github.com/JustGlowing/minisom">MiniSom</a></li>
              <li><a href="https://scikit-learn.org/stable/index.html">Scikit-learn</a></li>
              <li><a href="https://matplotlib.org/stable/index.html">Matplotlib</a></li>
            </p>
            <br>
            <p>
              <strong>Código-fonte utilizado disponível na seção Código.</strong>
            </p>
          </div>
        </div>
      </div>
    </section>
  </template>
</body>
<footer>
  <p>Este website está disponível no repositório do <a href="https://github.com/gabrielmsilva00/Redes-Neurais-MLP">GitHub</a></p>
  <p>© 2025 Gabriel Maia <a href="https://github.com/gabrielmsilva00">@GabrielMSilva00</a></p>
</footer>
</html>